<div class="altar-container">
  <!-- Header Section -->
  <div class="altar-header">
    <h1><i class="fas fa-star"></i> Pentagram Altar</h1>
    <p class="subtitle">Invoca los poderes de la naturaleza</p>
  </div>

  <div class="altar-content">
    <!-- Pentagram Section -->
    <div class="pentagram-section">
      <h2><i class="fas fa-magic"></i> Sacred Pentagram</h2>
      <div class="pentagram-container">
        <div class="pentagram-wrapper">
          <!-- Pentagram SVG -->
          <svg
            class="pentagram-svg"
            viewBox="0 0 200 200"
            xmlns="http://www.w3.org/2000/svg"
          >
            <!-- Pentagram lines -->
            <g
              class="pentagram-lines"
              stroke="#ffd700"
              stroke-width="3"
              fill="none"
            >
              <!-- Outer circle -->
              <circle
                cx="100"
                cy="100"
                r="95"
                stroke="#9d4edd"
                stroke-width="1"
                opacity="0.3"
              />

              <!-- Pentagram lines connecting all points -->
              <line x1="100" y1="10" x2="62" y2="180" class="pentagram-line" />
              <line x1="62" y1="180" x2="162" y2="70" class="pentagram-line" />
              <line x1="162" y1="70" x2="38" y2="70" class="pentagram-line" />
              <line x1="38" y1="70" x2="138" y2="180" class="pentagram-line" />
              <line x1="138" y1="180" x2="100" y2="10" class="pentagram-line" />
            </g>

            <!-- Element points -->
            @for (element of pentagramElements(); track element.id) {
            <g
              class="element-point"
              [style.cursor]="'pointer'"
              (click)="onElementClick(element)"
            >
              <circle
                [attr.cx]="element.position.x * 2"
                [attr.cy]="element.position.y * 2"
                r="15"
                [attr.fill]="element.color"
                class="element-circle"
                [class.pulsing]="true"
              />
              <text
                [attr.x]="element.position.x * 2"
                [attr.y]="element.position.y * 2 + 35"
                text-anchor="middle"
                fill="#ffd700"
                font-size="12"
                font-weight="bold"
                class="element-label"
              >
                {{ element.name }}
              </text>
            </g>
            }
          </svg>
        </div>

        <div class="pentagram-info">
          <p>
            Click on each element to discover its sacred properties and
            correspondences in ritual work.
          </p>
          <div class="elements-legend">
            @for (element of pentagramElements(); track element.id) {
            <div class="legend-item" (click)="onElementClick(element)">
              <div
                class="legend-color"
                [style.background-color]="element.color"
              ></div>
              <span>{{ element.name }} - {{ element.element }}</span>
            </div>
            }
          </div>
        </div>
      </div>
    </div>

    <!-- Rituals Section -->
    <div class="rituals-section">
      <h2><i class="fas fa-scroll"></i> Sacred Rituals</h2>
      <div class="rituals-grid">
        @for (ritual of rituals(); track ritual.id) {
        <div class="ritual-card" (click)="onRitualClick(ritual)">
          <div class="ritual-header">
            <h3>{{ ritual.name }}</h3>
            <div class="ritual-meta">
              <span class="ritual-type">{{ ritual.type }}</span>
              <span
                class="difficulty"
                [ngClass]="getDifficultyClass(ritual.difficulty)"
              >
                {{ ritual.difficulty }}
              </span>
            </div>
          </div>
          <p class="ritual-description">{{ ritual.description }}</p>
          <div class="ritual-elements">
            <span class="elements-label">Elements:</span>
            @for (elementId of ritual.elements; track elementId) {
            <span
              class="element-tag"
              [style.background-color]="getElementColor(elementId)"
            >
              {{ getElementName(elementId) }}
            </span>
            }
          </div>
          @if (ritual.moonPhase) {
          <div class="moon-phase">
            <span
              >{{ getMoonPhaseIcon(ritual.moonPhase) }}
              {{ ritual.moonPhase }} Moon</span
            >
          </div>
          }
        </div>
        }
      </div>
    </div>
  </div>

  <!-- Element Details Modal -->
  @if (showElementDetails() && selectedElement()) {
  <div class="modal element-modal show" (click)="onCloseElementDetails()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2 [style.color]="selectedElement()!.color">
          <i class="fas fa-circle" [style.color]="selectedElement()!.color"></i>
          {{ selectedElement()!.name }}
        </h2>
        <button class="close-btn" (click)="onCloseElementDetails()">
          &times;
        </button>
      </div>
      <div class="modal-body">
        <div class="element-details">
          <div class="element-info">
            <h3>{{ selectedElement()!.element }}</h3>
            <p class="element-description">
              {{ selectedElement()!.description }}
            </p>
          </div>
          <div class="element-properties">
            <h4>Sacred Properties:</h4>
            <div class="properties-grid">
              @for (property of selectedElement()!.properties; track property) {
              <span class="property-tag">{{ property }}</span>
              }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Ritual Details Modal -->
  @if (showRitualDetails() && selectedRitual()) {
  <div class="modal ritual-modal show" (click)="onCloseRitualDetails()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>
          <i class="fas fa-scroll"></i>
          {{ selectedRitual()!.name }}
        </h2>
        <button class="close-btn" (click)="onCloseRitualDetails()">
          &times;
        </button>
      </div>
      <div class="modal-body">
        <div class="ritual-details">
          <div class="ritual-meta-detailed">
            <div class="meta-item">
              <span class="label">Type:</span>
              <span class="value">{{ selectedRitual()!.type }}</span>
            </div>
            <div class="meta-item">
              <span class="label">Difficulty:</span>
              <span
                class="value difficulty"
                [ngClass]="getDifficultyClass(selectedRitual()!.difficulty)"
              >
                {{ selectedRitual()!.difficulty }}
              </span>
            </div>
            @if (selectedRitual()!.moonPhase) {
            <div class="meta-item">
              <span class="label">Moon Phase:</span>
              <span class="value"
                >{{ getMoonPhaseIcon(selectedRitual()!.moonPhase || "any") }}
                {{ selectedRitual()!.moonPhase }}</span
              >
            </div>
            }
          </div>

          <div class="ritual-description-detailed">
            <p>{{ selectedRitual()!.description }}</p>
          </div>

          <div class="materials-section">
            <h4><i class="fas fa-list"></i> Required Materials:</h4>
            <ul class="materials-list">
              @for (material of selectedRitual()!.materials; track material) {
              <li>{{ material }}</li>
              }
            </ul>
          </div>

          <div class="instructions-section">
            <h4><i class="fas fa-scroll"></i> Instructions:</h4>
            <ol class="instructions-list">
              @for (instruction of selectedRitual()!.instructions; track
              instruction) {
              <li>{{ instruction }}</li>
              }
            </ol>
          </div>

          <div class="ritual-elements-detailed">
            <h4><i class="fas fa-magic"></i> Elements Invoked:</h4>
            <div class="elements-detailed">
              @for (elementId of selectedRitual()!.elements; track elementId) {
              @if (getElementById(elementId); as element) {
              <div class="element-card-small">
                <div
                  class="element-color"
                  [style.background-color]="element.color"
                ></div>
                <div class="element-info-small">
                  <h5>{{ element.name }}</h5>
                  <span>{{ element.element }}</span>
                </div>
              </div>
              } }
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  }
</div>
